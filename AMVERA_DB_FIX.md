# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –ë–î –Ω–∞ Amvera

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ –Ω–∞ Amvera –æ—à–∏–±–∫–∞:
```
‚úó –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü: column "updated_at" does not exist
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ë–î —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å–æ —Å—Ç–∞—Ä–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π, –∏ –ø–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–æ–ª–æ–Ω–∫–µ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–û–±–Ω–æ–≤–ª–µ–Ω —Ñ–∞–π–ª `db-pg.js` –∏ —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π `db-migration.js` –¥–ª—è **–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π –ë–î**.

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

**–î–û (–æ–ø–∞—Å–Ω–æ):**
```javascript
// –ü—ã—Ç–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–æ–ª–æ–Ω–∫–µ
CREATE TABLE IF NOT EXISTS listings (...)
CREATE INDEX IF NOT EXISTS idx_listings_updated_at ON listings(updated_at);
// ‚ùå –û—à–∏–±–∫–∞ –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –±–µ–∑ –∫–æ–ª–æ–Ω–∫–∏ updated_at
```

**–ü–û–°–õ–ï (–±–µ–∑–æ–ø–∞—Å–Ω–æ):**
```javascript
// –°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤–ª—è–µ–º –∫–æ–ª–æ–Ω–∫—É –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
ALTER TABLE listings ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP;

// –ü–æ—Ç–æ–º —Å–æ–∑–¥–∞–µ–º –∏–Ω–¥–µ–∫—Å (IF NOT EXISTS –∑–∞—â–∏—â–∞–µ—Ç)
CREATE INDEX IF NOT EXISTS idx_listings_updated_at ON listings(updated_at);
// ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±–æ–π —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
```

---

## üöÄ –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ Amvera

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

–ü—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Amvera:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Amvera
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ù–∞–∂–º–∏—Ç–µ **Restart** (–∏–ª–∏ Redeploy)
4. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏—é

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–î –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –±—ã—Å—Ç—Ä–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ë–î –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ç–æ–π –∂–µ –ë–î
DATABASE_URL="postgresql://user:pass@host/db" \
node db-migration.js
```

–î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:
```
üîÑ –ù–∞—á–∏–Ω–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏—é –ë–î...
  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∞–±–ª–∏—Ü—É listings...
  ‚îú‚îÄ ‚úì –ö–æ–ª–æ–Ω–∫–∞ updated_at –¥–æ–±–∞–≤–ª–µ–Ω–∞ (–µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ)
  ‚îú‚îÄ –°–æ–∑–¥–∞–µ–º –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è listings...
  ‚îú‚îÄ ‚úì –ò–Ω–¥–µ–∫—Å—ã listings –≥–æ—Ç–æ–≤—ã
  ...
‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ë–î (–ï–°–õ–ò –ù–ò–ß–ï–ì–û –ù–ï –ü–û–ú–û–ì–ê–ï–¢)

–ï—Å–ª–∏ –≤ –ë–î –Ω–µ—Ç –≤–∞–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

1. –í Amvera: Services ‚Üí PostgreSQL ‚Üí Delete
2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é PostgreSQL
3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π DATABASE_URL
4. –û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
5. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–í–Ω–∏–º–∞–Ω–∏–µ:** –≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ë–î –ø—É—Å—Ç–∞.

---

## üìã –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏

–§–∞–π–ª `db-migration.js` –≤—ã–ø–æ–ª–Ω—è–µ—Ç:

```javascript
1. ‚úì –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É listings
   ‚îú‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç missing –∫–æ–ª–æ–Ω–∫—É updated_at (–µ—Å–ª–∏ –Ω–µ—Ç)
   ‚îî‚îÄ –°–æ–∑–¥–∞–µ—Ç –∏–Ω–¥–µ–∫—Å—ã (IF NOT EXISTS)

2. ‚úì –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É parse_sessions
   ‚îî‚îÄ –°–æ–∑–¥–∞–µ—Ç –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

3. ‚úì –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É listing_history
   ‚îî‚îÄ –°–æ–∑–¥–∞–µ—Ç –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

4. ‚úì –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É price_history
   ‚îî‚îÄ –°–æ–∑–¥–∞–µ—Ç –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

5. ‚úì –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É cron_logs
   ‚îî‚îÄ –°–æ–∑–¥–∞–µ—Ç –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

–†–µ–∑—É–ª—å—Ç–∞—Ç: –ë–î –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ, –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç
```

---

## ‚ú® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ** ‚Äî –Ω–µ –ª–æ–º–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
‚úÖ **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ** ‚Äî –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ** ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚úÖ **–ì–∏–±–∫–æ** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ë–î —Ä–∞–∑–Ω—ã—Ö –≤–æ–∑—Ä–∞—Å—Ç–æ–≤

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ï—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ, –≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

```
‚úì –ò—Å–ø–æ–ª—å–∑—É–µ–º DATABASE_URL –æ—Ç Amvera
‚úì –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
‚úì –í—Ä–µ–º—è —Å–µ—Ä–≤–µ—Ä–∞ –ë–î: Thu Oct 30 2025 02:17:19 GMT+0000

üîÑ –ù–∞—á–∏–Ω–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏—é –ë–î...
  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∞–±–ª–∏—Ü—É listings...
  ‚îú‚îÄ ‚úì –ö–æ–ª–æ–Ω–∫–∞ updated_at –¥–æ–±–∞–≤–ª–µ–Ω–∞ (–µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ)
  ‚îú‚îÄ –°–æ–∑–¥–∞–µ–º –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è listings...
  ‚îú‚îÄ ‚úì –ò–Ω–¥–µ–∫—Å—ã listings –≥–æ—Ç–æ–≤—ã
  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∞–±–ª–∏—Ü—É parse_sessions...
  ‚îú‚îÄ ‚úì –¢–∞–±–ª–∏—Ü–∞ parse_sessions –≥–æ—Ç–æ–≤–∞
  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∞–±–ª–∏—Ü—É listing_history...
  ‚îú‚îÄ ‚úì –¢–∞–±–ª–∏—Ü–∞ listing_history –≥–æ—Ç–æ–≤–∞
  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∞–±–ª–∏—Ü—É price_history...
  ‚îú‚îÄ ‚úì –¢–∞–±–ª–∏—Ü–∞ price_history –≥–æ—Ç–æ–≤–∞
  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∞–±–ª–∏—Ü—É cron_logs...
  ‚îî‚îÄ ‚úì –¢–∞–±–ª–∏—Ü–∞ cron_logs –≥–æ—Ç–æ–≤–∞

‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
   –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –∏–Ω–¥–µ–∫—Å—ã –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ
```

–ó–∞—Ç–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è:

```
üìÖ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–õ–ê–ù–ò–†–û–í–©–ò–ö–ê
‚úì –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫: –ê–ö–¢–ò–í–ï–ù
‚è∞ CRON –ü–ê–†–°–ò–ù–ì –í–ö–õ–Æ–ß–ï–ù
   –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: 1 0 * * *
   –¢–∞–π–º–∑–æ–Ω–∞: Europe/Moscow
‚úÖ Cron-–ø–∞—Ä—Å–∏–Ω–≥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

üöÄ API —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://0.0.0.0:3000
```

---

## üìû –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –∏—Å—á–µ–∑–ª–∞

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** –≤ Amvera (Logs tab)
2. **–£–±–µ–¥–∏—Ç–µ—Å—å**, —á—Ç–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Restart)
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ** DATABASE_URL –∏ DB_SSL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
4. **–°–≤—è–∂–∏—Ç–µ—Å—å** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Amvera –µ—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ –ë–î

---

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥ (–æ–ø–∞—Å–µ–Ω)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª CREATE TABLE IF NOT EXISTS
- –ü—ã—Ç–∞–ª–∞—Å—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤ –æ–¥–Ω–æ–º batch —Å CREATE TABLE
- –õ–æ–º–∞–ª–∞—Å—å –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ë–î —Å–æ —Å—Ç–∞—Ä–æ–π —Å—Ö–µ–º–æ–π

### –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ (–±–µ–∑–æ–ø–∞—Å–µ–Ω)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç ALTER TABLE ADD COLUMN IF NOT EXISTS
- –°–æ–∑–¥–∞–µ—Ç –∏–Ω–¥–µ–∫—Å—ã —Å IF NOT EXISTS –æ—Ç–¥–µ–ª—å–Ω–æ
- –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Å –Ω–æ–≤—ã–º–∏, —Ç–∞–∫ –∏ —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –ë–î
- –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –±–µ–∑ –æ—à–∏–±–æ–∫

---

**–í–µ—Ä—Å–∏—è:** 2.1.1 (—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏)
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** –æ–∫—Ç—è–±—Ä—å 2025
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
