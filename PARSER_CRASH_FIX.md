# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ë—Ä–∞—É–∑–µ—Ä –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ

## üî¥ –ü—Ä–æ–±–ª–µ–º–∞ (31 –æ–∫—Ç—è–±—Ä—è, 20:46)

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ "–ù–∞—á–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥" —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–ª –ø–∞—Ä—Å–µ—Ä, –Ω–æ:

```
‚ö° –ó–∞–ø—Ä–æ—Å 1464 (start=29260) –∑–∞–ø—É—â–µ–Ω –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
‚ö° –ó–∞–ø—Ä–æ—Å 1465 (start=29280) –∑–∞–ø—É—â–µ–Ω –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
...
‚ö° –ó–∞–ø—Ä–æ—Å 1500 (start=29980) –∑–∞–ø—É—â–µ–Ω –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ: Protocol error: Connection closed.
   Most likely the page has been closed.

üëã –ë—Ä–∞—É–∑–µ—Ä –∑–∞–∫—Ä—ã—Ç
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–∞—Ä—Å–µ—Ä –ø—ã—Ç–∞–ª—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å **500 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** –∫ —Å–∞–π—Ç—É, —á—Ç–æ –≤—ã–∑–≤–∞–ª–æ:
1. –ë–ª–æ–∫–∏—Ä–æ–≤–∫—É —Å–∞–π—Ç–æ–º (rate limiting)
2. –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
3. –ö—Ä–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞ Puppeteer

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ (31 –æ–∫—Ç—è–±—Ä—è, 20:47+)

### –ö–æ–º–º–∏—Ç: `73b5b72` - "Fix: reduce concurrent requests to prevent browser crashes"

**–ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ:**

#### 1. **server.js** (3 –º–µ—Å—Ç–∞)

**–°—Ç—Ä–æ–∫–∞ 89** - POST /api/parse:
```javascript
// –î–û:
concurrentRequests = 500,

// –ü–û–°–õ–ï:
concurrentRequests = 20,  // –°–Ω–∏–∂–µ–Ω–æ —Å 500 –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å–∞–π—Ç–æ–º
```

**–°—Ç—Ä–æ–∫–∞ 236** - POST /api/parse-differential:
```javascript
// –î–û:
concurrentRequests = 500,

// –ü–û–°–õ–ï:
concurrentRequests = 20,  // –°–Ω–∏–∂–µ–Ω–æ —Å 500 –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å–∞–π—Ç–æ–º
```

**–°—Ç—Ä–æ–∫–∞ 989** - runCronParsing():
```javascript
// –î–û:
concurrentRequests: Number(process.env.CONCURRENT_REQUESTS || 500),

// –ü–û–°–õ–ï:
concurrentRequests: Number(process.env.CONCURRENT_REQUESTS || 20),  // –°–Ω–∏–∂–µ–Ω–æ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
```

#### 2. **parser.js** (2 –º–µ—Å—Ç–∞)

**–°—Ç—Ä–æ–∫–∞ 17** - Constructor concurrentRequests:
```javascript
// –î–û:
this.concurrentRequests = options.concurrentRequests || 500;

// –ü–û–°–õ–ï:
this.concurrentRequests = options.concurrentRequests || 20;
// –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—Å–Ω–∏–∂–µ–Ω–æ —Å 500 –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
```

**–°—Ç—Ä–æ–∫–∞ 18** - Constructor requestDelayMs:
```javascript
// –î–û:
this.requestDelayMs = options.requestDelayMs || 50;

// –ü–û–°–õ–ï:
this.requestDelayMs = options.requestDelayMs || 100;
// –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ (—É–≤–µ–ª–∏—á–µ–Ω–æ —Å 50 –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏)
```

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ | –ü–æ—Å–ª–µ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|----------|-----|--------|-----------|
| **concurrentRequests** | 500 | 20 | –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ |
| **requestDelayMs** | 50ms | 100ms | –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ |
| **–≠—Ñ—Ñ–µ–∫—Ç** | 500 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ | 200 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ | –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–∞–π—Ç |

---

## üöÄ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π:

‚úÖ **–ë—Ä–∞—É–∑–µ—Ä Puppeteer –Ω–µ –±—É–¥–µ—Ç –ø–∞–¥–∞—Ç—å**
- –°–∞–π—Ç autonomera777.net –Ω–µ –±—É–¥–µ—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –ù–µ—Ç –æ—à–∏–±–∫–∏ "Protocol error: Connection closed"

‚úÖ **–ü–∞—Ä—Å–∏–Ω–≥ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ**
- –û–±—ä—è–≤–ª–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é
- –ü—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

‚úÖ **–°–æ–±–ª—é–¥–∞–µ—Ç—Å—è –≤–µ–∂–ª–∏–≤–æ–µ –ø–∞—Ä—Å–∏–Ω–≥ (respectful scraping)**
- 20 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ - —ç—Ç–æ –∞–¥–µ–∫–≤–∞—Ç–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞
- 100ms –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏ –¥–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä—É –≤—Ä–µ–º—è –æ—Ç–¥–æ—Ö–Ω—É—Ç—å

---

## üìù –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ï—Å–ª–∏ –≤—ã —É–∂–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–ª–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git pull origin main
```

### –ï—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω —Å—Ç–∞—Ä—ã–π —Å–µ—Ä–≤–µ—Ä:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (Ctrl+C –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)

# –û—á–∏—Å—Ç–∏—Ç–µ –∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
npm install

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä
node server.js
```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ö–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≤ –ª–æ–≥–∞—Ö:

```
‚ö° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤: 20 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–∑–∞–¥–µ—Ä–∂–∫–∞: 100ms)
```

–í–º–µ—Å—Ç–æ:

```
‚ö° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤: 500 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–∑–∞–¥–µ—Ä–∂–∫–∞: 50ms)
```

---

## üìö –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü–æ—á–µ–º—É 500 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ - —ç—Ç–æ –ø–ª–æ—Ö–æ?

1. **–î–ª—è –±—Ä–∞—É–∑–µ—Ä–∞**: Puppeteer –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç—ã –Ω–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–æ–±—ã—á–Ω–æ ~50-100)
2. **–î–ª—è —Å–∞–π—Ç–∞**: autonomera777.net –≤–∏–¥–∏—Ç –∞—Ç–∞–∫—É –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
3. **–î–ª—è —Å–µ—Ç–∏**: 500 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ = –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞

### –ü–æ—á–µ–º—É 20 –∑–∞–ø—Ä–æ—Å–æ–≤ - —ç—Ç–æ —Ö–æ—Ä–æ—à–æ?

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: 200 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É –≤—Å–µ –µ—â–µ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ
2. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤ –ª–µ–≥–∫–æ —ç—Ç–æ –≤—ã–¥–µ—Ä–∂–∏–≤–∞—é—Ç
3. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ú–µ–Ω—å—à–µ —à–∞–Ω—Å –Ω–∞ timeout –∏–ª–∏ rate limiting

### –ü–æ—á–µ–º—É 100ms –≤–º–µ—Å—Ç–æ 50ms?

- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä—É –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –±–∞—Ç—á
- –°–Ω–∏–∂–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å DDoS-–¥–µ—Ç–µ–∫—Ü–∏–∏
- –£–ª—É—á—à–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

---

## üîó GitHub

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: https://github.com/Aleksey341/Parser_Autonomera

**–ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–º–∏—Ç–æ–≤:**
```
73b5b72 Fix: reduce concurrent requests to prevent browser crashes    ‚Üê –ù–û–í–´–ô
cd11308 Fix parser: add price tracking and DB load endpoints
fcf432b Fix parser configuration: reduce concurrent requests...
...
```

---

## ‚ùì –í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã

**Q: –ë—É–¥–µ—Ç –ª–∏ –ø–∞—Ä—Å–∏–Ω–≥ –º–µ–¥–ª–µ–Ω–Ω–µ–µ?**
A: –ù–µ–º–Ω–æ–≥–æ, –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ. –õ—É—á—à–µ –º–µ–¥–ª–µ–Ω–Ω—ã–π, —á–µ–º —É–ø–∞–≤—à–∏–π –ø–∞—Ä—Å–µ—Ä.

**Q: –ú–æ–∂–Ω–æ –ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å —ç—Ç–æ —á–∏—Å–ª–æ —Å–Ω–æ–≤–∞?**
A: –ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å 30-50, –Ω–æ 20 - –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è autonomera777.

**Q: –ö–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥ (cron)?**
A: –¢–∞–∫ –∂–µ - –±—É–¥–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ. –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Ü–µ–ª–µ–π.

---

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ GitHub! üöÄ**
