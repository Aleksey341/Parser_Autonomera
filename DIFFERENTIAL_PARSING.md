# üîÑ –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ü–µ–Ω

–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω.

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ß—Ç–æ —Ç–∞–∫–æ–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥?](#—á—Ç–æ-—Ç–∞–∫–æ–µ-–¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π-–ø–∞—Ä—Å–∏–Ω–≥)
2. [–ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î](#–Ω–æ–≤—ã–µ-—Ç–∞–±–ª–∏—Ü—ã-–±–¥)
3. [API Endpoints](#api-endpoints)
4. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
5. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥?

**–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥** ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥ –ø–∞—Ä—Å–∏–Ω–≥–∞, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —Å–∏—Å—Ç–µ–º–∞:

1. **–°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç** —Å–ø–∞—Ä—Å–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ –ë–î
2. **–ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç** —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è (–∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–Ω—å—à–µ –Ω–µ –±—ã–ª–æ)
3. **–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç** –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –Ω–æ–º–µ—Ä–æ–≤
4. **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç** —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ/–Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

‚úÖ **–≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞** ‚Äî –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è –Ω–µ–Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚úÖ **–ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω** ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω
‚úÖ **–ò—Å—Ç–æ—Ä–∏—è** ‚Äî –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–æ–º–µ—Ä–∞
‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–æ—Å—Ç—É/—Å–Ω–∏–∂–µ–Ω–∏—é —Ü–µ–Ω

---

## –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î

### price_history

–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω:

```sql
CREATE TABLE price_history (
  id SERIAL PRIMARY KEY,
  number VARCHAR(15) NOT NULL,                -- –Ω–æ–º–µ—Ä –æ–±—ä—è–≤–ª–µ–Ω–∏—è
  old_price INTEGER,                          -- —Å—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞
  new_price INTEGER,                          -- –Ω–æ–≤–∞—è —Ü–µ–Ω–∞
  price_delta INTEGER,                        -- –∏–∑–º–µ–Ω–µ–Ω–∏–µ (new - old)
  change_direction VARCHAR(20),               -- 'increased', 'decreased', 'unchanged'
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  session_id VARCHAR(36),                     -- ID –ø–∞—Ä—Å–∏–Ω–≥–∞
  FOREIGN KEY (session_id) REFERENCES parse_sessions(id)
);

CREATE INDEX idx_price_history_number ON price_history(number);
CREATE INDEX idx_price_history_updated_at ON price_history(updated_at);
CREATE INDEX idx_price_history_session ON price_history(session_id);
```

**–≠—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î.**

---

## API Endpoints

### 1. –ó–∞–ø—É—Å–∫ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞

```bash
POST /api/parse-differential
Content-Type: application/json

{
  "minPrice": 0,
  "maxPrice": 999999999,
  "region": null,
  "maxPages": 200,
  "concurrentRequests": 500
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "sessionId": "session_1735404000000_abc123def",
  "status": "started",
  "message": "–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –Ω–∞—á–∞–ª—Å—è"
}
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞

```bash
GET /api/sessions/{sessionId}/status
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "sessionId": "session_1735404000000_abc123def",
  "status": "completed",
  "progress": 100,
  "listingsCount": 150,
  "isDifferential": true,
  "differential": {
    "totalParsed": 5000,
    "newItems": 150,
    "updatedItems": 45,
    "unchangedItems": 4805,
    "priceChangesCount": 45
  },
  "duration": "45s"
}
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ —Ü–µ–Ω

```bash
GET /api/sessions/{sessionId}/data
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "sessionId": "session_1735404000000_abc123def",
  "isDifferential": true,
  "count": 150,
  "priceChangesCount": 45,
  "priceChangesSummary": {
    "total": 45,
    "increased": 30,
    "decreased": 15,
    "totalPriceDelta": 125000
  },
  "listings": [
    {
      "number": "–ê123–í–•77",
      "price": 250000,
      "region": "–ú–æ—Å–∫–≤–∞",
      ...
    }
  ],
  "priceChanges": [
    {
      "number": "–ê456DE99",
      "oldPrice": 300000,
      "newPrice": 280000,
      "priceDelta": -20000,
      "changeDirection": "decreased"
    },
    {
      "number": "–í789–ö–•12",
      "oldPrice": 150000,
      "newPrice": 165000,
      "priceDelta": 15000,
      "changeDirection": "increased"
    }
  ]
}
```

### 4. –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞

```bash
GET /api/price-history/{number}?limit=10
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
GET /api/price-history/–ê123–í–•77?limit=10
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "number": "–ê123–í–•77",
  "count": 3,
  "history": [
    {
      "id": 1,
      "number": "–ê123–í–•77",
      "old_price": 240000,
      "new_price": 250000,
      "price_delta": 10000,
      "change_direction": "increased",
      "updated_at": "2025-01-20T15:30:00Z"
    },
    {
      "id": 2,
      "number": "–ê123–í–•77",
      "old_price": 230000,
      "new_price": 240000,
      "price_delta": 10000,
      "change_direction": "increased",
      "updated_at": "2025-01-19T15:30:00Z"
    },
    {
      "id": 3,
      "number": "–ê123–í–•77",
      "old_price": 200000,
      "new_price": 230000,
      "price_delta": 30000,
      "change_direction": "increased",
      "updated_at": "2025-01-18T15:30:00Z"
    }
  ]
}
```

### 5. –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω –∑–∞ –ø–µ—Ä–∏–æ–¥

```bash
GET /api/price-changes?days=7&limit=1000
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "period": "7 days",
  "count": 285,
  "changes": [
    {
      "id": 1001,
      "number": "–ê123–í–•77",
      "old_price": 240000,
      "new_price": 250000,
      "price_delta": 10000,
      "change_direction": "increased",
      "updated_at": "2025-01-20T15:30:00Z"
    },
    ...
  ]
}
```

### 6. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º —Ü–µ–Ω

```bash
GET /api/price-changes/stats?days=7
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "period": "7 days",
  "statistics": {
    "totalChanges": 285,
    "increased": 180,
    "decreased": 105,
    "unchanged": 0,
    "avgDelta": 5250,
    "minDelta": -50000,
    "maxDelta": 80000
  }
}
```

### 7. –í—Å–µ –Ω–æ–º–µ—Ä–∞ –∏–∑ –ë–î

```bash
GET /api/all-numbers
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "count": 5230,
  "numbers": [
    {
      "number": "–ê123–í–•77",
      "currentPrice": 250000
    },
    {
      "number": "–í456DE99",
      "currentPrice": 280000
    },
    ...
  ]
}
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ë–∞–∑–æ–≤—ã–π –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥

```bash
# 1. –ó–∞–ø—É—Å–∫ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
curl -X POST http://localhost:3000/api/parse-differential \
  -H "Content-Type: application/json" \
  -d '{"maxPages": 50}'

# –û—Ç–≤–µ—Ç:
# {
#   "sessionId": "session_1735404000000_abc123def",
#   "status": "started"
# }

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
curl http://localhost:3000/api/sessions/session_1735404000000_abc123def/status

# 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
curl http://localhost:3000/api/sessions/session_1735404000000_abc123def/data
```

### –ü—Ä–∏–º–µ—Ä 2: –ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω

```javascript
// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é
async function getPriceAnalytics() {
  const response = await fetch('/api/price-changes?days=7');
  const data = await response.json();

  const analysis = {
    totalChanges: data.count,
    increased: data.changes.filter(c => c.change_direction === 'increased').length,
    decreased: data.changes.filter(c => c.change_direction === 'decreased').length,
    avgIncrease: data.changes
      .filter(c => c.change_direction === 'increased')
      .reduce((sum, c) => sum + c.price_delta, 0) / data.count,
    avgDecrease: data.changes
      .filter(c => c.change_direction === 'decreased')
      .reduce((sum, c) => sum + c.price_delta, 0) / data.count
  };

  return analysis;
}
```

### –ü—Ä–∏–º–µ—Ä 3: –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è

```javascript
async function getPriceHistory(number) {
  const response = await fetch(`/api/price-history/${number}?limit=20`);
  const data = await response.json();

  if (!data.success) {
    console.error('–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
    return null;
  }

  // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç—Ä–µ–Ω–¥ —Ü–µ–Ω—ã
  const trend = data.history.map(h => ({
    date: h.updated_at,
    price: h.new_price,
    delta: h.price_delta,
    direction: h.change_direction
  }));

  return trend;
}
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º –ø–∞—Ä—Å–∏–Ω–≥–µ:

```
1. POST /api/parse-differential
   ‚Üì
2. runDifferentialParserWithDB()
   ‚Üì
3. parser.parse() ‚Äî –ø–∞—Ä—Å–∏—Ç —Å–∞–π—Ç
   ‚Üì
4. db.getDifferentialListings() ‚Äî —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å –ë–î
   ‚îú‚îÄ getExistingNumbers() ‚Äî –ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –Ω–æ–º–µ—Ä–∞ –∏–∑ –ë–î
   ‚îú‚îÄ –§–∏–ª—å—Ç—Ä—É–µ—Ç –Ω–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
   ‚îî‚îÄ –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω –≤ price_history
   ‚Üì
5. db.insertOrUpdateListing() ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
   ‚Üì
6. –°–µ—Å—Å–∏—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
   ‚îú‚îÄ newItems: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö
   ‚îú‚îÄ updatedItems: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Ü–µ–Ω—ã
   ‚îú‚îÄ unchangedItems: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   ‚îî‚îÄ priceChanges: –º–∞—Å—Å–∏–≤ —Å –¥–µ—Ç–∞–ª—è–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   ‚Üì
7. GET /api/sessions/{id}/data ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–π –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞:

#### db-pg.js (PostgreSQL):
- `getExistingNumbers()` ‚Äî –ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –Ω–æ–º–µ—Ä–∞ –∏ –∏—Ö —Ü–µ–Ω—ã
- `getDifferentialListings()` ‚Äî –≥–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- `recordPriceChange()` ‚Äî –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ history
- `getPriceHistory()` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è –æ–¥–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞
- `getRecentPriceChanges()` ‚Äî –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥
- `getPriceChangeStats()` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º

#### parser-db.js:
- `saveDifferentialListingsToDB()` ‚Äî –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
- `runDifferentialParserWithDB()` ‚Äî –∑–∞–ø—É—Å–∫ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞

#### server.js:
- `POST /api/parse-differential` ‚Äî endpoint –¥–ª—è –∑–∞–ø—É—Å–∫–∞
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `/api/sessions/:id/data` ‚Äî –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

---

## üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (`/api/parse`):
- ‚úÖ –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (—Å–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
- ‚úÖ –ü–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù—É–∂–Ω—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –≤—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (`/api/parse-differential`):
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ)
- ‚úÖ –ù—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω
- ‚úÖ –ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–æ—á–Ω–æ–π –¥–∏–Ω–∞–º–∏–∫–∏
- ‚úÖ –≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –ø–∞–º—è—Ç–∏

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–Ω –ø–æ –≤—Ä–µ–º–µ–Ω–∏:

```javascript
// –ü–æ–ª—É—á–∏—Ç—å —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É –∑–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø–æ—Å–ª–µ–¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
async function getDailyAveragePrice() {
  const stats = await fetch('/api/price-changes/stats?days=7').then(r => r.json());

  return {
    period: 'last 7 days',
    totalChanges: stats.statistics.totalChanges,
    priceIncreases: stats.statistics.increased,
    priceDecreases: stats.statistics.decreased,
    averageChange: stats.statistics.avgDelta,
    maxIncrease: stats.statistics.maxDelta,
    maxDecrease: stats.statistics.minDelta
  };
}
```

### –ù–∞–π—Ç–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Ü–µ–Ω—ã:

```javascript
async function getMaxPriceChanges(limit = 10) {
  const response = await fetch('/api/price-changes?limit=1000');
  const data = await response.json();

  const sorted = data.changes
    .sort((a, b) => Math.abs(b.price_delta) - Math.abs(a.price_delta))
    .slice(0, limit);

  return sorted;
}
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —á—Ç–æ –∏ –æ–±—ã—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥:

```json
{
  "minPrice": 0,           // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
  "maxPrice": 999999999,   // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
  "region": null,          // –†–µ–≥–∏–æ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  "maxPages": 200,         // –ú–∞–∫—Å–∏–º—É–º —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
  "concurrentRequests": 500,  // –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
  "requestDelayMs": 50     // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
}
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã price_history
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–∑–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π)
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- ‚úÖ –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á –Ω–∞ parse_sessions –¥–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

---

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –±—ã—Å—Ç—Ä–µ–µ:**
- –ù–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –ë–î (–±—ã—Å—Ç—Ä–æ)
- –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∫–ª–∏–µ–Ω—Ç—É

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –ö—ç—à–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã getExistingNumbers() –¥–ª—è –±–æ–ª—å—à–∏—Ö –ë–î
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ limit –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –±–æ–ª—å—à–∏—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ –∏—Å—Ç–æ—Ä–∏–∏

---

## ‚ú® –ì–æ—Ç–æ–≤–æ!

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ü–µ–Ω!

**–î–∞–ª—å—à–µ:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–∞—Ä—Å–∏–Ω–≥: `POST /api/parse-differential`
2. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å: `GET /api/sessions/{id}/status`
3. –ü–æ–ª—É—á–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: `GET /api/sessions/{id}/data`
4. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ü–µ–Ω—ã: `GET /api/price-changes`

---

**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** 2025-01-20
**–ü–æ–¥–¥–µ—Ä–∂–∫–∞:** MySQL 5.7+ –∏ PostgreSQL 10+
