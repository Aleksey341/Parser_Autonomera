# ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –ü–∞—Ä—Å–µ—Ä —Å –ë–î MySQL

–ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∑–∞ 5 –º–∏–Ω—É—Ç! üöÄ

---

## –®–∞–≥ 1Ô∏è‚É£: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ MySQL –∑–∞–ø—É—â–µ–Ω

```bash
# Windows
# –û—Ç–∫—Ä–æ–π—Ç–µ Services (services.msc) –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ MySQL80

# Linux
sudo systemctl start mysql

# Mac
brew services start mysql
```

---

## –®–∞–≥ 2Ô∏è‚É£: –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

–û—Ç–∫—Ä–æ–π—Ç–µ MySQL –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –í—Ö–æ–¥ –≤ MySQL
mysql -u root -p

# SQL –∫–æ–º–∞–Ω–¥—ã
CREATE DATABASE autonomera777;
EXIT;
```

---

## –®–∞–≥ 3Ô∏è‚É£: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# Database - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å!
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=–í–ê–®_–ü–ê–†–û–õ–¨_MYSQL    # ‚Üê –ò–∑–º–µ–Ω–∏—Ç–µ —ç—Ç–æ!
DB_NAME=autonomera777

# –í—Ä–µ–º—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
PARSER_TIME=00:00               # –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ –ø–æ–ª–Ω–æ—á—å
PARSER_TIMEZONE=Europe/Moscow

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ä—Å–∏–Ω–≥–∞
MAX_PAGES=50
MAX_PRICE=999999999
CONCURRENT_REQUESTS=500
```

---

## –®–∞–≥ 4Ô∏è‚É£: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
npm install

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
npm start
```

**–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:**

```
‚úì –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
‚úì –¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã/–ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
üìÖ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ –∑–∞–ø—É—â–µ–Ω
üöÄ API —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://0.0.0.0:3000
‚úÖ –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –†–ê–ë–û–¢–ï
```

---

## –®–∞–≥ 5Ô∏è‚É£: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞:

```
http://localhost:3000
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞.

---

## üìä –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

```
1. –ó–ê–ü–£–°–ö –ü–ê–†–°–ò–ù–ì–ê
   ‚Üì
2. –ü–ê–†–°–ï–† –°–û–ë–ò–†–ê–ï–¢ –î–ê–ù–ù–´–ï
   ‚Üì
3. –î–ê–ù–ù–´–ï –°–û–•–†–ê–ù–Ø–Æ–¢–°–Ø –í MySQL
   ‚Üì
4. –î–ê–ù–ù–´–ï –î–û–°–¢–£–ü–ù–´ –í–ò–ê API
   ‚Üì
5. –ö–ê–ñ–î–´–ô –î–ï–ù–¨ –í 00:00 - –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï ‚è∞
```

---

## üîë –ì–ª–∞–≤–Ω—ã–µ Endpoints

| URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|---------|
| `http://localhost:3000` | –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ |
| `http://localhost:3000/run` | –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ |
| `/api/data` | –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î |
| `/api/statistics` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| `/api/export?format=csv` | –°–∫–∞—á–∞—Ç—å CSV |
| `/api/db/status` | –°—Ç–∞—Ç—É—Å –ë–î |

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
curl http://localhost:3000/api/statistics

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ë–î
curl http://localhost:3000/api/db/status

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
curl http://localhost:3000/api/cron-logs
```

---

## ‚ùå –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –û—à–∏–±–∫–∞: "ECONNREFUSED"
MySQL –Ω–µ –∑–∞–ø—É—â–µ–Ω. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å MySQL.

### –û—à–∏–±–∫–∞: "Unknown database"
–í—ã –∑–∞–±—ã–ª–∏ —Å–æ–∑–¥–∞—Ç—å –ë–î. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
mysql -u root -p -e "CREATE DATABASE autonomera777;"
```

### –û—à–∏–±–∫–∞: "Access denied"
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å –≤ `.env` —Ñ–∞–π–ª–µ. –û–Ω –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –ø–∞—Ä–æ–ª–µ–º MySQL.

### –ü–∞—Ä—Å–∏–Ω–≥ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `PARSER_TIME` –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ MySQL —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–∞—Ä—Å–µ—Ä **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ** –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ **00:00** (–ø–æ–ª–Ω–æ—á—å).

–ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`:

```env
# –í 6:00 —É—Ç—Ä–∞
PARSER_TIME=06:00

# –í 18:00 (6 PM)
PARSER_TIME=18:00

# –í 12:00 (–ø–æ–ª–¥–µ–Ω—å)
PARSER_TIME=12:00
```

–ó–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä.

---

## üíæ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª:

```bash
# CSV —ç–∫—Å–ø–æ—Ä—Ç
curl "http://localhost:3000/api/export?format=csv" -o data.csv

# JSON —ç–∫—Å–ø–æ—Ä—Ç
curl "http://localhost:3000/api/export?format=json" -o data.json
```

---

## üéØ –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

```javascript
const db = require('./db');

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
const listings = await db.getListings({ limit: 100 });

// –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
const stats = await db.getListingsStats();

// –í—Å—Ç–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
await db.insertOrUpdateListing({
  number: '–ê123–í–•77',
  price: 250000,
  region: '77',
  status: 'active',
  seller: 'John Doe',
  url: 'https://...'
});
```

### –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞ –≤—Ä—É—á–Ω—É—é

```javascript
const { scheduledParseTask } = require('./parser-db');

// –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ –≤—Ä—É—á–Ω—É—é
await scheduledParseTask();
```

---

## üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–î–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å–º–æ—Ç—Ä–∏—Ç–µ `DATABASE_SETUP.md`

---

## ‚ú® –ì–æ—Ç–æ–≤–æ!

–í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ! üéâ

- ‚úÖ MySQL –ë–î –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
- ‚úÖ –ü–∞—Ä—Å–µ—Ä —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ë–î
- ‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø—É—â–µ–Ω—ã
- ‚úÖ API –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:3000

–ù–∞—á–Ω–∏—Ç–µ —Å:
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000/run —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `/api/data` —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
3. –°–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å!

---

**–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?** –°–º–æ—Ç—Ä–∏—Ç–µ `DATABASE_SETUP.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ üìñ
