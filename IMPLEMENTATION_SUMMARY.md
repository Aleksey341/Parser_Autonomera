# ‚úÖ –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ–∑—é–º–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–î–∞—Ç–∞:** –æ–∫—Ç—è–±—Ä—å 2025
**–í–µ—Ä—Å–∏—è:** 2.1.0
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ

---

## üìã –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. üóÑÔ∏è –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `db-pg.js`

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

#### `smartUpsertListing(listingData, sessionId)` (—Å—Ç—Ä–æ–∫–∞ 561)
–£–º–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –ª–æ–≥–∏–∫–æ–π —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:
- –ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ä—É—é –∑–∞–ø–∏—Å—å –∏–∑ –ë–î
- –í—Å—Ç–∞–≤–ª—è–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü—É `listings`
- **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∞—Ç—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** –Ω–∞ —Å–∞–π—Ç–µ
  - –ï—Å–ª–∏ –¥–∞—Ç–∞ –ù–ï –≤—ã—Ä–æ—Å–ª–∞ ‚Üí —Ç–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç `last_seen`
  - –ï—Å–ª–∏ –¥–∞—Ç–∞ –≤—ã—Ä–æ—Å–ª–∞ ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ü–µ–Ω—É
    - –ï—Å–ª–∏ —Ü–µ–Ω–∞ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å ‚Üí –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –∏—Å—Ç–æ—Ä–∏—é (–¥–∞—Ç–∞ + NULL –¥–µ–ª—å—Ç–∞)
    - –ï—Å–ª–∏ —Ü–µ–Ω–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å ‚Üí –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –∏—Å—Ç–æ—Ä–∏—é (–¥–∞—Ç–∞ + –¥–µ–ª—å—Ç–∞ + –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

#### `getLastPriceChange(number)` (—Å—Ç—Ä–æ–∫–∞ 643)
–ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞

#### `getListingsWithHistory(filters)` (—Å—Ç—Ä–æ–∫–∞ 667)
–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Å –ø–æ–¥—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã:
```sql
SELECT l.*, last_change FROM listings l
LEFT JOIN (SELECT ... FROM listing_history) AS last_change
```

### 2. ‚è∞ Cron-–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫

**–§–∞–π–ª:** `server.js`

#### `runCronParsing()` (—Å—Ç—Ä–æ–∫–∞ 943)
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 00:01:
1. –°–æ–∑–¥–∞–µ—Ç —Å–µ—Å—Å–∏—é –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤ –ë–î
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–∞—Ä—Å–µ—Ä —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏–∑ `.env`
3. –ü–∞—Ä—Å–∏—Ç —Å–∞–π—Ç (50-100 —Å—Ç—Ä–∞–Ω–∏—Ü)
4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç `smartUpsertListing()`
5. –°–æ–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (–Ω–æ–≤—ã–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
6. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–µ—Å—Å–∏–∏ –≤ –ë–î

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** (—Å—Ç—Ä–æ–∫–∞ 1250):
```javascript
if (process.env.CRON_ENABLED === 'true') {
  cron.schedule(CRON_TIME, () => runCronParsing(), { timezone })
}
```

### 3. üì° –ù–æ–≤—ã–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

**–§–∞–π–ª:** `server.js` (—Å—Ç—Ä–æ–∫–∏ 1056-1213)

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------|---------|
| `/api/db/overview` | GET | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑ –ë–î |
| `/api/db/data` | GET | –î–∞–Ω–Ω—ã–µ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| `/api/db/regions` | GET | –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º |
| `/api/db/sellers` | GET | –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –ø—Ä–æ–¥–∞–≤—Ü–∞–º |
| `/api/db/price-changes` | GET | –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω |
| `/api/db/export` | GET | –≠–∫—Å–ø–æ—Ä—Ç –≤ XLSX |

### 4. üé® –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

**–§–∞–π–ª:** `public/main.js` (—Å—Ç—Ä–æ–∫–∞ 46)

–§—É–Ω–∫—Ü–∏—è `startParsing()` –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∞:
- **–ë—ã–ª–æ:** –∑–∞–ø—É—Å–∫–∞–ª –ø–∞—Ä—Å–∏–Ω–≥ —Å–∞–π—Ç–∞ —á–µ—Ä–µ–∑ POST `/api/parse`
- **–°—Ç–∞–ª–æ:** –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î —á–µ—Ä–µ–∑ GET –∑–∞–ø—Ä–æ—Å—ã –∫ `/api/db/*`

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ —Å–µ—Ä–≤–µ—Ä–∞
2. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:
   - `/api/db/overview` ‚Üí —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   - `/api/db/data?limit=10000` ‚Üí —Ç–∞–±–ª–∏—Ü–∞
   - `/api/db/regions` ‚Üí —Ä–µ–≥–∏–æ–Ω—ã
3. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω

**–§–∞–π–ª:** `public/index.html`

- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∞: "–ù–∞—á–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥" ‚Üí **"üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –ë–î"**
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (—Å—Ç—Ä–æ–∫–∏ 162-247)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è "ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥"
- –£—Ç–æ—á–Ω–µ–Ω—ã —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### 5. ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–§–∞–π–ª:** `.env.example`

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
# CRON Configuration
CRON_ENABLED=true           # –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥
CRON_TIME=1 0 * * *         # –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ (00:01)
REQUEST_DELAY_MS=50         # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º–∏
PARSER_REGION=              # –†–µ–≥–∏–æ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

### 6. üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–æ–∑–¥–∞–Ω—ã –¥–≤–∞ –Ω–æ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞:

#### `SMART_DAILY_PARSING.md` (460 —Å—Ç—Ä–æ–∫)
- –ü–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- –î–∏–∞–≥—Ä–∞–º–º—ã –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –õ–æ–≥–∏–∫–∞ `smartUpsertListing` (–¥–µ—Ç–∞–ª—å–Ω–æ)
- –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ü—Ä–∏–º–µ—Ä—ã API –∑–∞–ø—Ä–æ—Å–æ–≤
- –¢–∞–±–ª–∏—Ü—ã –ë–î –∏ –∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- –û—Ç–ª–∞–¥–∫–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### `AMVERA_DEPLOYMENT_GUIDE.md` (380 —Å—Ç—Ä–æ–∫)
- –ü–æ—à–∞–≥–æ–≤—ã–π –¥–µ–ø–ª–æ–π –Ω–∞ Amvera
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ cron –∑–∞–ø—É—Å–∫–∞
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- Troubleshooting –∏ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram/Slack/Google Sheets

---

## üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã: –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Ü–∏–∫–ª

### –ü—Ä–∏–º–µ—Ä: –î–µ–Ω—å 1

**00:01** ‚Üí Cron –∑–∞–ø—É—Å–∫
```
runCronParsing()
‚îú‚îÄ –ü–∞—Ä—Å–∏—Ç —Å–∞–π—Ç ‚Üí [A123BC45 (150k), A456DE78 (200k), ...]
‚îú‚îÄ smartUpsertListing(A123BC45, session_1)
‚îÇ  ‚îú‚îÄ –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å? –î–ê ‚Üí INSERT –≤ listings
‚îÇ  ‚îú‚îÄ –í–µ—Ä—Å–∏—è –≤ –ë–î: price=null, date_updated=null
‚îÇ  ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: newEntry=true, historyRecorded=false
‚îú‚îÄ smartUpsertListing(A456DE78, session_1)
‚îÇ  ‚îú‚îÄ ... (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ)
‚îî‚îÄ –ò—Ç–æ–≥: new_items=5432, updated_items=0
```

### –î–µ–Ω—å 2 (24 —á–∞—Å–∞ —Å–ø—É—Å—Ç—è)

**00:01** ‚Üí Cron –∑–∞–ø—É—Å–∫
```
runCronParsing()
‚îú‚îÄ –ü–∞—Ä—Å–∏—Ç —Å–∞–π—Ç ‚Üí [A123BC45 (155k), A456DE78 (200k), ...]
‚îú‚îÄ smartUpsertListing(A123BC45, session_2)
‚îÇ  ‚îú‚îÄ –°—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î? –î–ê
‚îÇ  ‚îú‚îÄ –í–µ—Ä—Å–∏—è –≤ –ë–î: price=150k, date_updated='2025-10-29 00:05'
‚îÇ  ‚îú‚îÄ –ù–æ–≤–∞—è –¥–∞—Ç–∞: '2025-10-30 10:00' > '2025-10-29 00:05'? –î–ê
‚îÇ  ‚îú‚îÄ –¶–µ–Ω–∞: 155k != 150k? –î–ê ‚Üí –ò–ó–ú–ï–ù–ò–õ–ê–°–¨
‚îÇ  ‚îú‚îÄ price_delta = 155000 - 150000 = 5000
‚îÇ  ‚îú‚îÄ INSERT –≤ listing_history:
‚îÇ  ‚îÇ  ‚îî‚îÄ new_price=155k, price_delta=5000, is_price_changed=true
‚îÇ  ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: priceChanged=true, priceDelta=5000
‚îú‚îÄ smartUpsertListing(A456DE78, session_2)
‚îÇ  ‚îú‚îÄ –¶–µ–Ω–∞: 200k == 200k? –î–ê ‚Üí –ù–ï –∏–∑–º–µ–Ω–∏–ª–∞—Å—å
‚îÇ  ‚îú‚îÄ INSERT –≤ listing_history:
‚îÇ  ‚îÇ  ‚îî‚îÄ price_delta=NULL, is_price_changed=false
‚îÇ  ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: priceChanged=false
‚îî‚îÄ –ò—Ç–æ–≥: new_items=12, updated_items=5420
```

### –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –±—Ä–∞—É–∑–µ—Ä

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –ë–î"**

```
startParsing()
‚îú‚îÄ GET /api/db/overview
‚îÇ  ‚îî‚îÄ { total: 5432, avgPrice: 125000, lastUpdate: '2025-10-30' }
‚îú‚îÄ GET /api/db/data?limit=10000
‚îÇ  ‚îî‚îÄ [
‚îÇ      {
‚îÇ        number: 'A123BC45',
‚îÇ        price: 155000,
‚îÇ        date_updated: '2025-10-30 10:00',
‚îÇ        last_change: {
‚îÇ          price_delta: 5000,
‚îÇ          date_updated_site: '2025-10-30',
‚îÇ          is_price_changed: true
‚îÇ        }
‚îÇ      },
‚îÇ      ...
‚îÇ     ]
‚îú‚îÄ GET /api/db/regions
‚îÇ  ‚îî‚îÄ [ { region: '77', total: 1234, avg_price: 125000 }, ... ]
‚îÇ
‚îî‚îÄ –ë—Ä–∞—É–∑–µ—Ä –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:
   ‚îú‚îÄ üìä –û–±–∑–æ—Ä: total, avgPrice, regions, sellers, lastUpdate
   ‚îú‚îÄ üìã –î–∞–Ω–Ω—ã–µ: —Ç–∞–±–ª–∏—Ü–∞ —Å –∫–æ–ª–æ–Ω–∫–æ–π "–ò–∑–º. —Ü–µ–Ω—ã" –∏ "–î–∞—Ç–∞ –∏–∑–º."
   ‚îú‚îÄ üåç –ü–æ —Ä–µ–≥–∏–æ–Ω–∞–º: –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
   ‚îî‚îÄ üì• –≠–∫—Å–ø–æ—Ä—Ç: —Å–∫–∞—á–∞—Ç—å XLSX —Å –∏—Å—Ç–æ—Ä–∏–µ–π
```

---

## üìä –¢–∞–±–ª–∏—Ü—ã –ë–î

### listings
```sql
id, number(UNIQUE), price, region, status,
date_posted, date_updated, seller, url,
parsed_at, updated_at
```

### listing_history
```sql
id, number(FK), old_price, new_price, price_delta,
change_direction, date_updated_site, is_price_changed,
recorded_at, session_id(FK)
```

### parse_sessions
```sql
id(PK), started_at, completed_at, status,
total_items, new_items, updated_items, params(JSONB), error
```

---

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Amvera

### –ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

1. **–°–æ–∑–¥–∞—Ç—å PostgreSQL** –≤ Amvera
2. **–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å DATABASE_URL**
3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```
   CRON_ENABLED=true
   CRON_TIME=1 0 * * *
   PARSER_TIMEZONE=Europe/Moscow
   ```
4. **–ü—É—à–∏—Ç—å –∫–æ–¥** ‚Üí –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π
5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:** `/api/health` –∏ `/api/db/overview`
6. **–û—Ç–∫—Ä—ã—Ç—å:** –±—Ä–∞—É–∑–µ—Ä ‚Üí `https://your-app.amvera.app`
7. **–ù–∞–∂–∞—Ç—å:** –∫–Ω–æ–ø–∫–∞ "üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –ë–î"

### –ü—Ä–æ–≤–µ—Ä–∫–∞ cron

```bash
# –í –ª–æ–≥–∞—Ö (Amvera –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
ü§ñ CRON-–ü–ê–†–°–ò–ù–ì –ó–ê–ü–£–©–ï–ù: 2025-10-30T00:01:00.000Z
‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω: 5432 –æ–±—ä—è–≤–ª–µ–Ω–∏–π
üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:
   - –ù–æ–≤—ã—Ö: 120
   - –û–±–Ω–æ–≤–ª–µ–Ω–æ: 850
   - –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: 4462
```

---

## ‚ú® –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

| –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|-----|-------|
| –ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∫–ª–∏–∫–µ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥ 00:01 |
| –ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π | –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω —Å –¥–∞—Ç–∞–º–∏ |
| –ù–µ—Ç —É–º–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞—Ç –∏ —Ü–µ–Ω |
| –ë—Ä–∞—É–∑–µ—Ä –ø–∞—Ä—Å–∏—Ç —Å–∞–π—Ç | –ë—Ä–∞—É–∑–µ—Ä –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑ –ë–î |
| –ú–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫ | –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–ª–∏–∫ < 1—Å–µ–∫ |
| –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è | –í—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–π –ë–î |

---

## üìÅ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

```
‚îå‚îÄ db-pg.js                              ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã 3 —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ server.js                             ‚úÖ Cron + 6 API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
‚îú‚îÄ public/main.js                        ‚úÖ –ü–µ—Ä–µ–ø–∏—Å–∞–Ω–∞ startParsing()
‚îú‚îÄ public/index.html                     ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
‚îú‚îÄ .env.example                          ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã Cron –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
‚îú‚îÄ SMART_DAILY_PARSING.md               ‚ú® –ù–û–í–´–ô - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ AMVERA_DEPLOYMENT_GUIDE.md           ‚ú® –ù–û–í–´–ô - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–µ–ø–ª–æ—è
‚îî‚îÄ IMPLEMENTATION_SUMMARY.md             ‚ú® –ù–û–í–´–ô - —ç—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã (–∑–∞—â–∏—Ç–∞ –æ—Ç SQL injection)
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –î–∞–Ω–Ω—ã–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env`

‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ cron –∑–∞–ø—É—Å–∫–µ
- –ó–∞—â–∏—Ç–∞ –æ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ cron (—Ñ–ª–∞–≥ `cronTaskRunning`)
- Fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ –ë–î
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö
- –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏

‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±—Ä–∞—É–∑–µ—Ä–µ (Promise.all)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ LIMIT –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –æ–±—ä–µ–º–∞
- –ò–Ω–¥–µ–∫—Å—ã –≤ –ë–î –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–û–±–Ω–æ–≤–ª–µ–Ω–∞/—Å–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

1. ‚úÖ **SMART_DAILY_PARSING.md** (460 —Å—Ç—Ä) ‚Äî –ø–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
2. ‚úÖ **AMVERA_DEPLOYMENT_GUIDE.md** (380 —Å—Ç—Ä) ‚Äî –¥–µ–ø–ª–æ–π –Ω–∞ –æ–±–ª–∞–∫–æ
3. ‚úÖ **IMPLEMENTATION_SUMMARY.md** (—ç—Ç–æ —Ñ–∞–π–ª) ‚Äî —Ä–µ–∑—é–º–µ
4. ‚úÖ **README.md** ‚Äî –≥–ª–∞–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
5. ‚úÖ **ARCHITECTURE.md** ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
6. ‚úÖ **API_REFERENCE.md** ‚Äî API (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç)

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç

- [x] –†–∞—Å—à–∏—Ä–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ `listing_history` —Å –ø–æ–ª—è–º–∏ –¥–ª—è –¥–∞—Ç –∏ –¥–µ–ª—å—Ç —Ü–µ–Ω
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `smartUpsertListing()` —Å –ª–æ–≥–∏–∫–æ–π —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- [x] –î–æ–±–∞–≤–ª–µ–Ω cron-–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ –≤ 00:01
- [x] –°–æ–∑–¥–∞–Ω—ã API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ –ë–î
- [x] –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥: –∫–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑ –ë–î
- [x] –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ HTML
- [x] –°–æ–∑–¥–∞–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∏ –¥–µ–ø–ª–æ—é
- [x] –ü—Ä–æ–≤–µ–¥–µ–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏
- [x] –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [x] –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ Amvera

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ Amvera:** —Å–º. `AMVERA_DEPLOYMENT_GUIDE.md`
2. **–î–æ–∂–¥–∞—Ç—å—Å—è 00:01:** –ø–µ—Ä–≤—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:** –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–∏—Å–∏ –æ cron –∑–∞–ø—É—Å–∫–µ
4. **–ù–∞–∂–∞—Ç—å "–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –ë–î":** —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
5. **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel:** –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞: `amvera logs`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `/api/health` endpoint
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `/api/db/overview` endpoint
4. –°–º–æ—Ç—Ä–µ—Ç—å **AMVERA_DEPLOYMENT_GUIDE.md** —Ä–∞–∑–¥–µ–ª "Troubleshooting"
5. –°–º–æ—Ç—Ä–µ—Ç—å **SMART_DAILY_PARSING.md** —Ä–∞–∑–¥–µ–ª "–û—Ç–ª–∞–¥–∫–∞"

---

**–°–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚úÖ –ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£

**–í–µ—Ä—Å–∏—è:** 2.1.0
**–î–∞—Ç–∞:** –æ–∫—Ç—è–±—Ä—å 2025
**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ:** —É–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω

